#
# Policy Language policy - Kernel + Userspace objects
#
# This policy has been generated using the Reference Policy
# flask files: initial_sids, security_classes and access_vectors files
# from: ../common-policy-files/flask_files
#
class security
class process
class system
class capability
class filesystem
class file
class dir
class fd
class lnk_file
class chr_file
class blk_file
class sock_file
class fifo_file
class socket
class tcp_socket
class udp_socket
class rawip_socket
class node
class netif
class netlink_socket
class packet_socket
class key_socket
class unix_stream_socket
class unix_dgram_socket
class sem
class msg
class msgq
class shm
class ipc
class passwd
class x_drawable
class x_screen
class x_gc
class x_font
class x_colormap
class x_property
class x_selection
class x_cursor
class x_client
class x_device
class x_server
class x_extension
class netlink_route_socket
class netlink_firewall_socket
class netlink_tcpdiag_socket
class netlink_nflog_socket
class netlink_xfrm_socket
class netlink_selinux_socket
class netlink_audit_socket
class netlink_ip6fw_socket
class netlink_dnrt_socket
class dbus
class nscd
class association
class netlink_kobject_uevent_socket
class appletalk_socket
class packet
class key
class context
class dccp_socket
class memprotect
class db_database
class db_table
class db_procedure
class db_column
class db_tuple
class db_blob
class peer
class capability2
class x_resource
class x_event
class x_synthetic_event
class x_application_data
class kernel_service
class tun_socket
class x_pointer
class x_keyboard
class db_schema
class db_view
class db_sequence
class db_language
class service

sid kernel
sid security
sid unlabeled
sid fs
sid file
sid file_labels
sid init
sid any_socket
sid port
sid netif
sid netmsg
sid node
sid igmp_packet
sid icmp_socket
sid tcp_socket
sid sysctl_modprobe
sid sysctl
sid sysctl_fs
sid sysctl_kernel
sid sysctl_net
sid sysctl_net_unix
sid sysctl_vm
sid sysctl_dev
sid kmod
sid policy
sid scmp_packet
sid devnull

class security { compute_av compute_create compute_member check_context load_policy compute_relabel compute_user setenforce setbool setsecparam setcheckreqprot read_policy }
class process { fork transition sigchld sigkill sigstop signull signal ptrace getsched setsched getsession getpgid setpgid getcap setcap share getattr setexec setfscreate noatsecure siginh setrlimit rlimitinh dyntransition setcurrent execmem execstack execheap setkeycreate setsockcreate }
class system { ipc_info syslog_read syslog_mod syslog_console module_request }
class capability { chown dac_override dac_read_search fowner fsetid kill setgid setuid setpcap linux_immutable net_bind_service net_broadcast net_admin net_raw ipc_lock ipc_owner sys_module sys_rawio sys_chroot sys_ptrace sys_pacct sys_admin sys_boot sys_nice sys_resource sys_time sys_tty_config mknod lease audit_write audit_control setfcap }
class filesystem { mount remount unmount getattr relabelfrom relabelto transition associate quotamod quotaget }
class file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton execute_no_trans entrypoint execmod open audit_access }
class dir { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton add_name remove_name reparent search rmdir open audit_access execmod }
class fd { use }
class lnk_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod }
class chr_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton execute_no_trans entrypoint execmod open audit_access }
class blk_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod }
class sock_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod }
class fifo_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod }
class socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind }
class tcp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind connectto newconn acceptfrom node_bind name_connect }
class udp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind }
class rawip_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind }
class node { tcp_recv tcp_send udp_recv udp_send rawip_recv rawip_send enforce_dest dccp_recv dccp_send recvfrom sendto }
class netif { tcp_recv tcp_send udp_recv udp_send rawip_recv rawip_send dccp_recv dccp_send ingress egress }
class netlink_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind }
class packet_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind }
class key_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind }
class unix_stream_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind connectto newconn acceptfrom }
class unix_dgram_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind }
class sem { create destroy getattr setattr read write associate unix_read unix_write }
class msg { send receive }
class msgq { create destroy getattr setattr read write associate unix_read unix_write enqueue }
class shm { create destroy getattr setattr read write associate unix_read unix_write lock }
class ipc { create destroy getattr setattr read write associate unix_read unix_write }
class passwd { passwd chfn chsh rootok crontab }
class x_drawable { create destroy read write blend getattr setattr list_child add_child remove_child list_property get_property set_property manage override show hide send receive }
class x_screen { getattr setattr hide_cursor show_cursor saver_getattr saver_setattr saver_hide saver_show }
class x_gc { create destroy getattr setattr use }
class x_font { create destroy getattr add_glyph remove_glyph use }
class x_colormap { create destroy read write getattr add_color remove_color install uninstall use }
class x_property { create destroy read write append getattr setattr }
class x_selection { read write getattr setattr }
class x_cursor { create destroy read write getattr setattr use }
class x_client { destroy getattr setattr manage }
class x_device { getattr setattr use read write getfocus setfocus bell force_cursor freeze grab manage list_property get_property set_property add remove create destroy }
class x_server { getattr setattr record debug grab manage }
class x_extension { query use }
class netlink_route_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write }
class netlink_firewall_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write }
class netlink_tcpdiag_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write }
class netlink_nflog_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind }
class netlink_xfrm_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write }
class netlink_selinux_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind }
class netlink_audit_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write nlmsg_relay nlmsg_readpriv nlmsg_tty_audit }
class netlink_ip6fw_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write }
class netlink_dnrt_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind }
class dbus { acquire_svc send_msg }
class nscd { getpwd getgrp gethost getstat admin shmempwd shmemgrp shmemhost getserv shmemserv }
class association { sendto recvfrom setcontext polmatch }
class netlink_kobject_uevent_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind }
class appletalk_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind }
class packet { send recv relabelto flow_in flow_out forward_in forward_out }
class key { view read write search link setattr create }
class context { translate contains }
class dccp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind name_connect }
class memprotect { mmap_zero }
class db_database { create drop getattr setattr relabelfrom relabelto access install_module load_module get_param set_param }
class db_table { create drop getattr setattr relabelfrom relabelto use select update insert delete lock }
class db_procedure { create drop getattr setattr relabelfrom relabelto execute entrypoint install }
class db_column { create drop getattr setattr relabelfrom relabelto use select update insert }
class db_tuple { relabelfrom relabelto use select update insert delete }
class db_blob { create drop getattr setattr relabelfrom relabelto read write import export }
class peer { recv }
class capability2 { mac_override mac_admin syslog }
class x_resource { read write }
class x_event { send receive }
class x_synthetic_event { send receive }
class x_application_data { paste paste_after_confirm copy }
class kernel_service { use_as_override create_files_as }
class tun_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind }
class x_pointer { getattr setattr use read write getfocus setfocus bell force_cursor freeze grab manage list_property get_property set_property add remove create destroy }
class x_keyboard { getattr setattr use read write getfocus setfocus bell force_cursor freeze grab manage list_property get_property set_property add remove create destroy }
class db_schema { create drop getattr setattr relabelfrom relabelto search add_name remove_name }
class db_view { create drop getattr setattr relabelfrom relabelto expand }
class db_sequence { create drop getattr setattr relabelfrom relabelto get_value next_value set_value }
class db_language { create drop getattr setattr relabelfrom relabelto implement execute }
class service { start stop status reload kill }

#
# This policycap statement will be used in a netlabel module exercise
# to show network_peer_controls. For now comment out:
#policycap network_peer_controls;

################################################################################################################
type sober_manifest_t;
type sober_cert_t;
type sober_login_conf_t;

type sober_app_t;
type sober_app_bin_t;

type sober_appmand_t;
type sober_appmand_exec_t;

type sober_login_t;
type sober_loginscreen_exec_t;

type sober_store_t;
type sober_soberstore_exec_t;

type sober_desktop_t;
type sober_desktop_exec_t;

type_transition unconfined_t    sober_appmand_exec_t:       process sober_appmand_t;

type_transition sober_appmand_t sober_loginscreen_exec_t:   process sober_login_t;
type_transition sober_appmand_t sober_desktop_exec_t:       process sober_desktop_t;
type_transition sober_appmand_t sober_soberstore_exec_t:    process sober_store_t;
type_transition sober_appmand_t sober_app_bin_t:            process sober_app_t;
############################

allow sober_appmand_t           sober_desktop_t:     dbus { acquire_svc send_msg };
allow sober_desktop_t           sober_appmand_t:     dbus { acquire_svc send_msg };

allow sober_appmand_t           sober_login_t:       dbus { acquire_svc send_msg };
allow sober_login_t             sober_appmand_t:     dbus { acquire_svc send_msg };

allow sober_appmand_t           sober_store_t:       dbus { acquire_svc send_msg };
allow sober_store_t             sober_appmand_t:     dbus { acquire_svc send_msg };

allow sober_appmand_t           unconfined_t:        dbus { acquire_svc send_msg };
allow unconfined_t              sober_appmand_t:     dbus { acquire_svc send_msg };

allow sober_login_t             unconfined_t:        dbus { acquire_svc send_msg };
allow unconfined_t              sober_login_t:       dbus { acquire_svc send_msg };

allow sober_store_t             unconfined_t:        dbus { acquire_svc send_msg };
allow unconfined_t              sober_store_t:       dbus { acquire_svc send_msg };

allow sober_desktop_t           unconfined_t:        dbus { acquire_svc send_msg };
allow unconfined_t              sober_desktop_t:     dbus { acquire_svc send_msg };

allow sober_app_t               unconfined_t:       dbus { acquire_svc send_msg };
allow unconfined_t              sober_app_t:        dbus { acquire_svc send_msg };
#============= sober_manifest_t ==============
allow sober_manifest_t unconfined_t:filesystem associate;

#============= sober_app_t ==============

allow sober_app_t sober_manifest_t:dir search;

allow sober_app_t self:capability dac_override;

#!!!! This avc is allowed in the current policy
allow sober_app_t self:dir { search getattr };

#!!!! This avc is allowed in the current policy
allow sober_app_t self:file { read getattr };
allow sober_app_t self:fifo_file { read getattr write };
#!!!! This avc is allowed in the current policy
allow sober_app_t self:lnk_file { read getattr };

allow sober_app_t self:netlink_route_socket { write read };
allow sober_app_t self:netlink_route_socket { bind create getattr nlmsg_read };

#!!!! This avc is allowed in the current policy
allow sober_app_t self:process { execmem fork getsched sigkill };

allow sober_app_t self:tcp_socket { write read };
allow sober_app_t self:tcp_socket { connect getopt getattr create setopt };

allow sober_app_t self:udp_socket { write read };
allow sober_app_t self:udp_socket { ioctl getattr create connect };

#!!!! This avc is allowed in the current policy
allow sober_app_t self:unix_stream_socket { write read create connect getattr };

#!!!! The file '/data/bin/MemoryTester' is mislabeled on your system.  
#!!!! Fix with $ restorecon -R -v /data/bin/MemoryTester
allow sober_app_t sober_app_bin_t:file { getattr entrypoint };
allow sober_app_t sober_appmand_t:dir search;

#!!!! This avc is allowed in the current policy
allow sober_app_t sober_appmand_t:fd use;
allow sober_app_t sober_appmand_t:file { read getattr };
allow sober_app_t sober_appmand_t:process sigchld;
allow sober_app_t sober_login_t:dir search;
allow sober_app_t sober_login_t:file { read getattr };

#!!!! This avc is allowed in the current policy
allow sober_app_t unconfined_t:association recvfrom;
allow sober_app_t unconfined_t:association sendto;

#!!!! The file '/dev/null' is mislabeled on your system.  
#!!!! Fix with $ restorecon -R -v /dev/null
allow sober_app_t unconfined_t:chr_file { read write ioctl getattr };
allow sober_app_t unconfined_t:dir { read getattr search };

#!!!! This avc is allowed in the current policy
allow sober_app_t unconfined_t:fd use;
allow sober_app_t unconfined_t:file { read getattr execute execute_no_trans };
allow sober_app_t unconfined_t:filesystem getattr;
allow sober_app_t unconfined_t:lnk_file read;
allow sober_app_t unconfined_t:sock_file write;
allow sober_app_t unconfined_t:tcp_socket name_connect;

allow sober_app_t unconfined_t:unix_stream_socket connectto;
allow sober_app_t unconfined_t:process sigchld;

#============= sober_appmand_t ==============

allow sober_appmand_t self:capability { sys_nice ipc_lock dac_override sys_admin };

#!!!! This avc is allowed in the current policy
allow sober_appmand_t self:dir { search getattr };

#!!!! This avc is allowed in the current policy
allow sober_appmand_t self:file { read getattr };

#!!!! This avc is allowed in the current policy
allow sober_appmand_t self:lnk_file { read getattr };
allow sober_appmand_t self:memprotect mmap_zero;
allow sober_appmand_t self:process { execmem setsched };

#!!!! This avc is allowed in the current policy
allow sober_appmand_t self:process { fork sigstop sigkill sigchld signal signull getsched };

#!!!! This avc is allowed in the current policy
allow sober_appmand_t self:unix_stream_socket { write read create connect getattr };
allow sober_appmand_t sober_app_bin_t:file { read getattr unlink execute };
allow sober_appmand_t sober_app_t:process transition;

allow sober_appmand_t sober_app_t:process { siginh rlimitinh noatsecure };
allow sober_appmand_t sober_appmand_exec_t:file entrypoint;

allow sober_appmand_t sober_login_t:process { siginh rlimitinh noatsecure };

#!!!! The file '/usr/bin/LoginScreen' is mislabeled on your system.  
#!!!! Fix with $ restorecon -R -v /usr/bin/LoginScreen
allow sober_appmand_t sober_login_t:process { sigstop signal transition signull };
allow sober_appmand_t sober_loginscreen_exec_t:file { read execute };
allow sober_appmand_t sober_manifest_t:dir { read write search getattr remove_name };
allow sober_appmand_t sober_manifest_t:file { read getattr unlink };
allow sober_appmand_t sober_soberstore_exec_t:file { read execute };

#!!!! The file '/usr/bin/Soberstore' is mislabeled on your system.  
#!!!! Fix with $ restorecon -R -v /usr/bin/Soberstore
allow sober_appmand_t sober_store_t:process transition;

allow sober_appmand_t sober_store_t:process { siginh rlimitinh noatsecure };

#!!!! The file '/dev/mmcblk0p3' is mislabeled on your system.  
#!!!! Fix with $ restorecon -R -v /dev/mmcblk0p3
allow sober_appmand_t unconfined_t:blk_file { read getattr unlink ioctl };

#!!!! The file '/dev/null' is mislabeled on your system.  
#!!!! Fix with $ restorecon -R -v /dev/null
allow sober_appmand_t unconfined_t:chr_file { read write getattr ioctl };

#!!!! The file '/opt/Qt-5.5.0-Pandaboard/lib' is mislabeled on your system.  
#!!!! Fix with $ restorecon -R -v /opt/Qt-5.5.0-Pandaboard/lib
allow sober_appmand_t unconfined_t:dir { read write getattr remove_name search };

#!!!! This avc is allowed in the current policy
allow sober_appmand_t unconfined_t:fd use;
allow sober_appmand_t unconfined_t:file { write execute getattr read ioctl execute_no_trans };
allow sober_appmand_t unconfined_t:filesystem { getattr unmount };
allow sober_appmand_t unconfined_t:lnk_file read;

#!!!! This avc is allowed in the current policy
allow sober_appmand_t unconfined_t:process sigchld;
allow sober_appmand_t unconfined_t:unix_stream_socket connectto;

allow sober_appmand_t sober_desktop_exec_t:file { read execute };

#!!!! This avc has a dontaudit rule in the current policy
allow sober_appmand_t sober_desktop_t:process { siginh rlimitinh noatsecure };

#!!!! The file '/usr/bin/DesktopScreen' is mislabeled on your system.  
#!!!! Fix with $ restorecon -R -v /usr/bin/DesktopScreen
allow sober_appmand_t sober_desktop_t:process { sigstop signull signal transition sigkill };


#============= sober_login_t ==============
allow sober_login_t self:capability { sys_nice mknod ipc_lock dac_override sys_admin};

#!!!! This avc is allowed in the current policy
allow sober_login_t self:dir { search getattr };

#!!!! This avc is allowed in the current policy
allow sober_login_t self:fifo_file { read write getattr ioctl };

#!!!! This avc is allowed in the current policy
allow sober_login_t self:file { read write getattr };

#!!!! This avc is allowed in the current policy
allow sober_login_t self:lnk_file { read getattr };
allow sober_login_t self:process { execmem setfscreate setsched };

#!!!! This avc is allowed in the current policy
allow sober_login_t self:process { fork getsched sigchld };

allow sober_login_t self:tcp_socket { write read };
allow sober_login_t self:tcp_socket { getopt create connect getattr };

#!!!! This avc is allowed in the current policy
allow sober_login_t self:unix_stream_socket { write read create connect getattr };

#!!!! This avc is allowed in the current policy
allow sober_login_t sober_appmand_t:fd use;
allow sober_login_t sober_appmand_t:process sigchld;
allow sober_login_t sober_cert_t:dir search;
allow sober_login_t sober_cert_t:file { read getattr };
allow sober_login_t sober_login_conf_t:file { read write };
allow sober_login_t sober_loginscreen_exec_t:file { getattr entrypoint };
allow sober_login_t sober_manifest_t:dir { read getattr search };

#!!!! This avc is allowed in the current policy
allow sober_login_t unconfined_t:association recvfrom;
allow sober_login_t unconfined_t:association sendto;
allow sober_login_t unconfined_t:blk_file { write ioctl setattr read create unlink getattr };

#!!!! The file '/dev/null' is mislabeled on your system.  
#!!!! Fix with $ restorecon -R -v /dev/null
allow sober_login_t unconfined_t:chr_file { read write getattr ioctl };

#!!!! The file '/opt/Qt-5.5.0-Pandaboard/lib' is mislabeled on your system.  
#!!!! Fix with $ restorecon -R -v /opt/Qt-5.5.0-Pandaboard/lib
allow sober_login_t unconfined_t:dir { write getattr read remove_name create add_name mounton search };

#!!!! This avc is allowed in the current policy
allow sober_login_t unconfined_t:fd use;
allow sober_login_t unconfined_t:file { read getattr execute ioctl execute_no_trans };
allow sober_login_t unconfined_t:filesystem { getattr mount unmount };
allow sober_login_t unconfined_t:lnk_file read;
allow sober_login_t unconfined_t:system module_request;
allow sober_login_t unconfined_t:tcp_socket name_connect;
allow sober_login_t unconfined_t:unix_stream_socket connectto;
allow sober_login_t unconfined_t:process sigchld;

#============= sober_store_t ==============
allow sober_store_t self:capability { fowner chown fsetid dac_override };

#!!!! This avc is allowed in the current policy
allow sober_store_t self:dir { search getattr };

#!!!! This avc is allowed in the current policy
allow sober_store_t self:fifo_file { read write getattr };

#!!!! This avc is allowed in the current policy
allow sober_store_t self:file { read write getattr };

#!!!! This avc is allowed in the current policy
allow sober_store_t self:lnk_file { read getattr };
allow sober_store_t self:process { execmem setfscreate };

#!!!! This avc is allowed in the current policy
allow sober_store_t self:process { fork getsched sigchld };

allow sober_store_t self:tcp_socket { write read };
allow sober_store_t self:tcp_socket { getopt create connect getattr };

#!!!! This avc is allowed in the current policy
allow sober_store_t self:unix_stream_socket { write read create connect getattr };
allow sober_store_t sober_app_bin_t:dir { write read search add_name remove_name };
allow sober_store_t sober_app_bin_t:file { write getattr setattr read create unlink ioctl };

#!!!! This avc is allowed in the current policy
allow sober_store_t sober_appmand_t:fd use;
allow sober_store_t sober_appmand_t:process sigchld;
allow sober_store_t sober_cert_t:file { read getattr };
allow sober_store_t sober_manifest_t:dir { write getattr add_name search };
allow sober_store_t sober_manifest_t:file { write create getattr };
allow sober_store_t sober_soberstore_exec_t:file { getattr entrypoint };

#!!!! This avc is allowed in the current policy
allow sober_store_t unconfined_t:association recvfrom;
allow sober_store_t unconfined_t:association sendto;

#!!!! The file '/dev/null' is mislabeled on your system.  
#!!!! Fix with $ restorecon -R -v /dev/null
allow sober_store_t unconfined_t:chr_file { read write getattr ioctl };

#!!!! The file '/opt/Qt-5.5.0-Pandaboard/lib' is mislabeled on your system.  
#!!!! Fix with $ restorecon -R -v /opt/Qt-5.5.0-Pandaboard/lib
allow sober_store_t unconfined_t:dir { remove_name read write getattr add_name search };

#!!!! This avc is allowed in the current policy
allow sober_store_t unconfined_t:fd use;
allow sober_store_t unconfined_t:file { read getattr execute execute_no_trans };
allow sober_store_t unconfined_t:filesystem getattr;
allow sober_store_t unconfined_t:lnk_file read;
allow sober_store_t unconfined_t:tcp_socket name_connect;
allow sober_store_t unconfined_t:unix_stream_socket connectto;

allow sober_store_t sober_cert_t:dir search;

#============= sober_app_bin_t ==============
allow sober_app_bin_t unconfined_t:filesystem associate;


#============= sober_desktop_t ==============

allow sober_desktop_t sober_login_t:file read;
allow sober_desktop_t sober_login_t:dir search;

allow sober_desktop_t self:capability { sys_nice ipc_lock dac_override sys_admin sys_ptrace };

#!!!! This avc is allowed in the current policy
allow sober_desktop_t self:dir { search getattr };

#!!!! This avc is allowed in the current policy
allow sober_desktop_t self:file { read getattr };

#!!!! This avc is allowed in the current policy
allow sober_desktop_t self:lnk_file { read getattr };
allow sober_desktop_t self:process { execmem setsched };

#!!!! This avc is allowed in the current policy
allow sober_desktop_t self:process { fork getsched sigchld };

#!!!! This avc is allowed in the current policy
allow sober_desktop_t self:unix_stream_socket { write read create connect getattr };

#!!!! This avc is allowed in the current policy
allow sober_desktop_t sober_appmand_t:fd use;
allow sober_desktop_t sober_appmand_t:process sigchld;
allow sober_desktop_t sober_appmand_t:dir search;
allow sober_desktop_t sober_appmand_t:file read;

#!!!! The file '/usr/bin/DesktopScreen' is mislabeled on your system.  
#!!!! Fix with $ restorecon -R -v /usr/bin/DesktopScreen
allow sober_desktop_t sober_desktop_exec_t:file { getattr entrypoint };
allow sober_desktop_t sober_manifest_t:dir { getattr search };

#!!!! The file '/dev/mmcblk0p3' is mislabeled on your system.  
#!!!! Fix with $ restorecon -R -v /dev/mmcblk0p3
allow sober_desktop_t unconfined_t:blk_file { read getattr unlink ioctl };

#!!!! The file '/dev/ttyS0' is mislabeled on your system.  
#!!!! Fix with $ restorecon -R -v /dev/ttyS0
allow sober_desktop_t unconfined_t:chr_file { read write getattr ioctl };

#!!!! The file '/opt/Qt-5.5.0-Pandaboard/lib' is mislabeled on your system.  
#!!!! Fix with $ restorecon -R -v /opt/Qt-5.5.0-Pandaboard/lib
allow sober_desktop_t unconfined_t:dir { read write getattr remove_name search };

#!!!! This avc is allowed in the current policy
allow sober_desktop_t unconfined_t:fd use;
allow sober_desktop_t unconfined_t:file { read getattr execute ioctl execute_no_trans };
allow sober_desktop_t unconfined_t:filesystem { getattr unmount };
allow sober_desktop_t unconfined_t:lnk_file read;
allow sober_desktop_t unconfined_t:unix_stream_socket connectto;
allow sober_desktop_t unconfined_t:process { signal sigchld };

#============= unconfined_t ==============
allow unconfined_t sober_app_t:dir search;
allow unconfined_t sober_app_t:process { signal sigkill };
allow unconfined_t sober_app_t:file read;

allow unconfined_t sober_appmand_exec_t:file { read getattr execute };
allow unconfined_t sober_appmand_t:dir { search getattr };
allow unconfined_t sober_appmand_t:file read;
allow unconfined_t sober_appmand_t:process { siginh rlimitinh transition sigkill noatsecure signal };

allow unconfined_t sober_login_t:dir { search getattr };
allow unconfined_t sober_login_t:file read;
allow unconfined_t sober_login_t:process { signal sigkill };

allow unconfined_t sober_store_t:dir search;
allow unconfined_t sober_store_t:file read;

allow unconfined_t sober_desktop_t:dir search;
allow unconfined_t sober_desktop_t:file read;
allow unconfined_t sober_desktop_t:process { signal sigkill };

############################
type  unconfined_t;
role  unconfined_r;
role unconfined_r types { unconfined_t sober_manifest_t sober_cert_t sober_login_conf_t sober_app_t sober_app_bin_t sober_appmand_t sober_appmand_exec_t sober_login_t sober_loginscreen_exec_t sober_store_t sober_soberstore_exec_t sober_desktop_t sober_desktop_exec_t };
################################################################################################################

allow unconfined_t unconfined_t:security { compute_av compute_create compute_member check_context load_policy compute_relabel compute_user setenforce setbool setsecparam setcheckreqprot read_policy };
allow unconfined_t unconfined_t:process { fork transition sigchld sigkill sigstop signull signal ptrace getsched setsched getsession getpgid setpgid getcap setcap share getattr setexec setfscreate noatsecure siginh setrlimit rlimitinh dyntransition setcurrent execmem execstack execheap setkeycreate setsockcreate };
allow unconfined_t unconfined_t:system { ipc_info syslog_read syslog_mod syslog_console module_request };
allow unconfined_t unconfined_t:capability { chown dac_override dac_read_search fowner fsetid kill setgid setuid setpcap linux_immutable net_bind_service net_broadcast net_admin net_raw ipc_lock ipc_owner sys_module sys_rawio sys_chroot sys_ptrace sys_pacct sys_admin sys_boot sys_nice sys_resource sys_time sys_tty_config mknod lease audit_write audit_control setfcap };
allow unconfined_t unconfined_t:filesystem { mount remount unmount getattr relabelfrom relabelto transition associate quotamod quotaget };
allow unconfined_t unconfined_t:file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton execute_no_trans entrypoint execmod open audit_access };
allow unconfined_t unconfined_t:dir { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton add_name remove_name reparent search rmdir open audit_access execmod };
allow unconfined_t unconfined_t:fd { use };
allow unconfined_t unconfined_t:lnk_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod };
allow unconfined_t unconfined_t:chr_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton execute_no_trans entrypoint execmod open audit_access };
allow unconfined_t unconfined_t:blk_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod };
allow unconfined_t unconfined_t:sock_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod };
allow unconfined_t unconfined_t:fifo_file { ioctl read write create getattr setattr lock relabelfrom relabelto append unlink link rename execute swapon quotaon mounton open audit_access execmod };
allow unconfined_t unconfined_t:socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
allow unconfined_t unconfined_t:tcp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind connectto newconn acceptfrom node_bind name_connect };
allow unconfined_t unconfined_t:udp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind };
allow unconfined_t unconfined_t:rawip_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind };
allow unconfined_t unconfined_t:node { tcp_recv tcp_send udp_recv udp_send rawip_recv rawip_send enforce_dest dccp_recv dccp_send recvfrom sendto };
allow unconfined_t unconfined_t:netif { tcp_recv tcp_send udp_recv udp_send rawip_recv rawip_send dccp_recv dccp_send ingress egress };
allow unconfined_t unconfined_t:netlink_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
allow unconfined_t unconfined_t:packet_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
allow unconfined_t unconfined_t:key_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
allow unconfined_t unconfined_t:unix_stream_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind connectto newconn acceptfrom };
allow unconfined_t unconfined_t:unix_dgram_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
allow unconfined_t unconfined_t:sem { create destroy getattr setattr read write associate unix_read unix_write };
allow unconfined_t unconfined_t:msg { send receive };
allow unconfined_t unconfined_t:msgq { create destroy getattr setattr read write associate unix_read unix_write enqueue };
allow unconfined_t unconfined_t:shm { create destroy getattr setattr read write associate unix_read unix_write lock };
allow unconfined_t unconfined_t:ipc { create destroy getattr setattr read write associate unix_read unix_write };
allow unconfined_t unconfined_t:passwd { passwd chfn chsh rootok crontab };
allow unconfined_t unconfined_t:x_drawable { create destroy read write blend getattr setattr list_child add_child remove_child list_property get_property set_property manage override show hide send receive };
allow unconfined_t unconfined_t:x_screen { getattr setattr hide_cursor show_cursor saver_getattr saver_setattr saver_hide saver_show };
allow unconfined_t unconfined_t:x_gc { create destroy getattr setattr use };
allow unconfined_t unconfined_t:x_font { create destroy getattr add_glyph remove_glyph use };
allow unconfined_t unconfined_t:x_colormap { create destroy read write getattr add_color remove_color install uninstall use };
allow unconfined_t unconfined_t:x_property { create destroy read write append getattr setattr };
allow unconfined_t unconfined_t:x_selection { read write getattr setattr };
allow unconfined_t unconfined_t:x_cursor { create destroy read write getattr setattr use };
allow unconfined_t unconfined_t:x_client { destroy getattr setattr manage };
allow unconfined_t unconfined_t:x_device { getattr setattr use read write getfocus setfocus bell force_cursor freeze grab manage list_property get_property set_property add remove create destroy };
allow unconfined_t unconfined_t:x_server { getattr setattr record debug grab manage };
allow unconfined_t unconfined_t:x_extension { query use };
allow unconfined_t unconfined_t:netlink_route_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
allow unconfined_t unconfined_t:netlink_firewall_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
allow unconfined_t unconfined_t:netlink_tcpdiag_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
allow unconfined_t unconfined_t:netlink_nflog_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
allow unconfined_t unconfined_t:netlink_xfrm_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
allow unconfined_t unconfined_t:netlink_selinux_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
allow unconfined_t unconfined_t:netlink_audit_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write nlmsg_relay nlmsg_readpriv nlmsg_tty_audit };
allow unconfined_t unconfined_t:netlink_ip6fw_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
allow unconfined_t unconfined_t:netlink_dnrt_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
allow unconfined_t unconfined_t:dbus { acquire_svc send_msg };
allow unconfined_t unconfined_t:nscd { getpwd getgrp gethost getstat admin shmempwd shmemgrp shmemhost getserv shmemserv };
allow unconfined_t unconfined_t:association { sendto recvfrom setcontext polmatch };
allow unconfined_t unconfined_t:netlink_kobject_uevent_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
allow unconfined_t unconfined_t:appletalk_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
allow unconfined_t unconfined_t:packet { send recv relabelto flow_in flow_out forward_in forward_out };
allow unconfined_t unconfined_t:key { view read write search link setattr create };
allow unconfined_t unconfined_t:context { translate contains };
allow unconfined_t unconfined_t:dccp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind name_connect };
allow unconfined_t unconfined_t:memprotect { mmap_zero };
allow unconfined_t unconfined_t:db_database { create drop getattr setattr relabelfrom relabelto access install_module load_module get_param set_param };
allow unconfined_t unconfined_t:db_table { create drop getattr setattr relabelfrom relabelto use select update insert delete lock };
allow unconfined_t unconfined_t:db_procedure { create drop getattr setattr relabelfrom relabelto execute entrypoint install };
allow unconfined_t unconfined_t:db_column { create drop getattr setattr relabelfrom relabelto use select update insert };
allow unconfined_t unconfined_t:db_tuple { relabelfrom relabelto use select update insert delete };
allow unconfined_t unconfined_t:db_blob { create drop getattr setattr relabelfrom relabelto read write import export };
allow unconfined_t unconfined_t:peer { recv };
allow unconfined_t unconfined_t:capability2 { mac_override mac_admin syslog };
allow unconfined_t unconfined_t:x_resource { read write };
allow unconfined_t unconfined_t:x_event { send receive };
allow unconfined_t unconfined_t:x_synthetic_event { send receive };
allow unconfined_t unconfined_t:x_application_data { paste paste_after_confirm copy };
allow unconfined_t unconfined_t:kernel_service { use_as_override create_files_as };
allow unconfined_t unconfined_t:tun_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
allow unconfined_t unconfined_t:x_pointer { getattr setattr use read write getfocus setfocus bell force_cursor freeze grab manage list_property get_property set_property add remove create destroy };
allow unconfined_t unconfined_t:x_keyboard { getattr setattr use read write getfocus setfocus bell force_cursor freeze grab manage list_property get_property set_property add remove create destroy };
allow unconfined_t unconfined_t:db_schema { create drop getattr setattr relabelfrom relabelto search add_name remove_name };
allow unconfined_t unconfined_t:db_view { create drop getattr setattr relabelfrom relabelto expand };
allow unconfined_t unconfined_t:db_sequence { create drop getattr setattr relabelfrom relabelto get_value next_value set_value };
allow unconfined_t unconfined_t:db_language { create drop getattr setattr relabelfrom relabelto implement execute };
allow unconfined_t unconfined_t:service { start stop status reload kill };

user unconfined_u roles { unconfined_r };
user system_u roles { unconfined_r };

#
# This role constraint statement will be used to show limiting
# a role transition in the external gateway. For now comment out:
#constrain process transition (r1 == r2);

sid kernel system_u:unconfined_r:unconfined_t
sid security system_u:object_r:unconfined_t
sid unlabeled system_u:object_r:unconfined_t
sid fs system_u:object_r:unconfined_t
sid file system_u:object_r:unconfined_t
sid file_labels system_u:object_r:unconfined_t
sid init system_u:object_r:unconfined_t
sid any_socket system_u:object_r:unconfined_t
sid port system_u:object_r:unconfined_t
sid netif system_u:object_r:unconfined_t
sid netmsg system_u:object_r:unconfined_t
sid node system_u:object_r:unconfined_t
sid igmp_packet system_u:object_r:unconfined_t
sid icmp_socket system_u:object_r:unconfined_t
sid tcp_socket system_u:object_r:unconfined_t
sid sysctl_modprobe system_u:object_r:unconfined_t
sid sysctl system_u:object_r:unconfined_t
sid sysctl_fs system_u:object_r:unconfined_t
sid sysctl_kernel system_u:object_r:unconfined_t
sid sysctl_net system_u:object_r:unconfined_t
sid sysctl_net_unix system_u:object_r:unconfined_t
sid sysctl_vm system_u:object_r:unconfined_t
sid sysctl_dev system_u:object_r:unconfined_t
sid kmod system_u:object_r:unconfined_t
sid policy system_u:object_r:unconfined_t
sid scmp_packet system_u:object_r:unconfined_t
sid devnull system_u:object_r:unconfined_t

fs_use_xattr ext2 system_u:object_r:unconfined_t;
fs_use_xattr ext3 system_u:object_r:unconfined_t;
fs_use_xattr ext4 system_u:object_r:unconfined_t;
fs_use_xattr jfs system_u:object_r:unconfined_t;
fs_use_xattr xfs system_u:object_r:unconfined_t;
fs_use_xattr reiserfs system_u:object_r:unconfined_t;
fs_use_xattr jffs2 system_u:object_r:unconfined_t;
fs_use_xattr gfs2 system_u:object_r:unconfined_t;
fs_use_xattr lustre system_u:object_r:unconfined_t;

fs_use_task eventpollfs system_u:object_r:unconfined_t;
fs_use_task pipefs system_u:object_r:unconfined_t;
fs_use_task sockfs system_u:object_r:unconfined_t;

fs_use_trans mqueue system_u:object_r:unconfined_t;
fs_use_trans devpts system_u:object_r:unconfined_t;
fs_use_trans hugetlbfs system_u:object_r:unconfined_t;
fs_use_trans tmpfs system_u:object_r:unconfined_t;
fs_use_trans shm system_u:object_r:unconfined_t;

genfscon selinuxfs / system_u:object_r:unconfined_t
genfscon proc / system_u:object_r:unconfined_t
